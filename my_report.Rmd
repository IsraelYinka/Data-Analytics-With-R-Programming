---
title: "Case Study (Bellabeat Fitness Company)"
author: "By Israel Yinka"
date: "2022-10-21"
output:
  html_document: default
  pdf_document: default
---

```{r include=FALSE}
library(rmarkdown)
library(datasets)
library(dplyr)
library(magrittr)
library(knitr)
library(tidyr)
library(forcats)
library(ggplot2)
library(tidyverse)
```

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Scenario
I am a junior data analyst on the marketing analyst team at Bellabeat, a high-tech manufacturer of feminine health products. A successful little firm, Bellabeat has the ability to expand and take over the global market for smart gadgets. Urka Sren, co-founder and chief creative officer of Bellabeat, believes that examining fitness data from smart devices might provide the company with new development opportunities. To better understand how people engage with their smart devices, I've been asked to focus on one of Bellabeat's products and analyze data from linked devices. The information I uncover will then have an impact on the company's marketing strategy.

## Bellabeat Products 
**Bellabeat App:** Access to health data on one's exercise, sleep, stress, menstrual cycle, and mindfulness practices is made available to users. Users may utilize this knowledge to understand their habits and make healthy decisions. The Bellabeat app is compatible with their collection of smart wellness products.

**Leaf:** The classic wellness tracker from Bellabeat is offered as a clip, necklace, or bracelet. The Leaf tracker connects to the Bellabeat app to monitor activity, sleep, and stress.

**Time:** This health watch has the typical look of a wristwatch while tracking user activity, sleep, and stress. The Bellabeat app is connected to the Time watch in order to provide you insights into your daily wellness.

**Spring:** This water bottle makes use of a daily water intake measurement method.

## Ask
In order to understand important (successful and failed) consumer trends in the worldwide market for smart devices, the business task is to examine non-Bellabeat smart device user data. The results of this study will also have an impact on the next Bellabeat marketing plans and assist identifying how to apply these trends to Bellabeat clients. Such insights are applied to the Bellabeat App and to future products in order to optimize profits and growth for the company and to capitalize on Bellabeat's rapidly growing user base in the smart device/tech-wellness sector. Urka Sren, Sando Mur (the other co-founder and a significant member of the Bellabeat executive team), the Bellabeat executive team, the Bellabeat Marketing Analytics Team, and the Bellabeat stakeholders are the key Bellabeat players.

## Prepare Data
**Data Source:** FitBit Fitness Tracker Data (CC0: Public Domain, dataset made available through Mobius).

**Data Not Reliable:** Since just 30 carefully selected individuals, as opposed to the 30+ million FitBit users overall, are included in this data, it is skewed. More specifically, I would have preferred at least a year's worth of data because the data was only gathered over the course of two months, which is insufficient time to discover reliable and accurate trends.

**Data Not Original:** The data set was created by survey respondents who responded to a distributed survey made possible by Amazon Mechanical Turk. It would have been better if FitBit had directly delivered the information.

**Data Not Comprehensive:** I would prefer to have information covering a year's duration of time; the data was only acquired during a two-month period, which is insufficient. Furthermore, it is hard to tell whether the people were picked at random or with prejudice.

**Data Not Current:** Since the data were collected six years ago, they do not represent current trends in data gathering.

**Importing Dataset:**
```{r}
daily_activity <- read.csv("dailyActivity_merged.csv")
sleep_daily <- read.csv("sleepDay_merged.csv")
daily_calories <- read.csv("dailyCalories_merged.csv")
```

## Process Data
**Verifying Data:** I had to make sure that the data sets had loaded correctly and without any mistakes.

```{r}
head(daily_activity)
```

```{r}
head(sleep_daily)
```
```{r}
head(daily_calories)
```

```{r}
colnames(daily_activity)
```
```{r}
colnames(sleep_daily)
```
```{r}
colnames(daily_calories)
```

View(daily_activity)
View(sleep_daily)
View(daily_calories)

I learned through looking over the data sets that some people didn't want to track their sleep, and some didn't want to do it for the full month. This will makes conducting a full analysis much more difficult than expected.
Additionally, several days had zero statistics recorded that had to be deleted.

```{r}
daily_activity_new <- daily_activity %>% 
  filter(TotalSteps !=0)
```

```{r}
sleep_daily_new <- sleep_daily %>% 
  filter(TotalSleepRecords !=0)
```
```{r}
daily_calories_new <- daily_calories %>% 
  filter (Calories !=0)
```

I also divided the date and time column into two independent columns in the sleep data set.

```{r}
sleep_daily_new_2 <- sleep_daily_new %>% 
  separate(SleepDay, c("Date", "Time"), " ")
```

View(sleep_daily_new)

```{r}
n_distinct(daily_activity_new$Id)
```

```{r}
n_distinct(daily_calories_new$Id)
```

```{r}
n_distinct(sleep_daily_new_2$Id)
```

Only 24 individuals entered their sleep data. Furthermore, although the data source claims that the sample size consists of 30 persons, the daily activity data actually lists 33 individuals.

```{r}
nrow(daily_activity_new)
```

```{r}
nrow(daily_calories_new)
```

```{r}
nrow(sleep_daily_new_2)
```

```{r}
nrow(unique(daily_activity_new))
```

```{r}
nrow(unique(daily_calories_new))
```

```{r}
nrow(unique(sleep_daily_new_2))
```

I created unique rows for the data sets to further tidy it up.

```{r}
sleep_daily_final <- unique(sleep_daily_new_2)
daily_activity_final <- unique(daily_activity_new)
daily_calories_final <- unique(daily_calories_new)
```

## Analyse Data
Each data collection had to just contain the columns I would use for my more in-depth analysis.

```{r}
daily_activity_final_2 <- daily_activity_final %>% 
  select(Id, ActivityDate, TotalSteps, VeryActiveMinutes, FairlyActiveMinutes, LightlyActiveMinutes,SedentaryMinutes,
         Calories)
sleep_daily_final_2 <- sleep_daily_final %>% 
  select(Id, Date, TotalMinutesAsleep, TotalTimeInBed)
```

```{r}
mean(daily_activity_final_2$TotalSteps)
mean(daily_activity_final_2$VeryActiveMinutes)
mean(daily_activity_final_2$FairlyActiveMinutes)
mean(daily_activity_final_2$LightlyActiveMinutes)
mean(daily_activity_final_2$SedentaryMinutes)
mean(daily_activity_final_2$Calories)
mean(sleep_daily_final_2$TotalMinutesAsleep)
mean(sleep_daily_final_2$TotalTimeInBed)
```

**Trends:** 
* On average, a person takes 8053 total steps each day. 
* On average, people spend 23.02 minutes being Very Active, 14.78 minutes being Fairly Active, 210 minutes being Lightly Active, and 955.6 minutes being Sedentary.
* Compared to the 419.2 minutes spent sleeping, people spent 458.5 minutes on average in bed.
The individuals got somewhat less sleep than the minimum number of 7 hours recommended for adults, or an average of 955.8 minutes each day, or nearly 16 hours per day.

**Questions:** 
* In what ways may Bellabeat promote regularity in user login and data tracking?
* How would Bellabeat help the average user reach the necessary daily Total Steps goal?
* How would Bellabeat help users get a better night's sleep?

## Share

**Using graphics to convey key thoughts and discoveries:**
```{r}
VeryActiveMin <- sum(daily_activity_final_2$VeryActiveMinutes)
FairlyActiveMin <- sum(daily_activity_final_2$FairlyActiveMinutes)
LightlyActiveMin <- sum(daily_activity_final_2$LightlyActiveMinutes)
SedentaryMin <- sum(daily_activity_final_2$SedentaryMinutes)
TotalMin <- VeryActiveMin + FairlyActiveMin + LightlyActiveMin + SedentaryMin
```

```{r}
dataset <- tribble(
  ~ VariantClass, ~ PASS_ONTARGET,
  "VeryActiveMin",     2,
  "FairlyActiveMin",   1,
  "LightlyActive",     17,
  "Sedentary",         79,
  
) %>% 
  mutate(VariantClass = fct_reorder(VariantClass, PASS_ONTARGET))

ggplot(dataset, aes(x = "", y = PASS_ONTARGET, fill = VariantClass)) +
  geom_col(width = 1) + 
  coord_polar(theta = "y") +
  xlab(NULL)

```

```{r}
my_plot_a <- ggplot(data=daily_activity_final_2) +
  geom_point(mapping=aes(x=TotalSteps, y=Calories), color="red") +
  geom_smooth(mapping=aes(x=TotalSteps, y=Calories)) +
  labs(title="The Relationship Between Total Steps and Calories Burned", x="Total Steps", y="Calories Burned (kcal)")

combined_data <- merge(daily_activity_final_2, sleep_daily_final_2, by="Id")

```

```{r my_plot_a, echo=FALSE}
plot(my_plot_a)
```

```{r}
my_plot_b <- ggplot(data=combined_data) +
  geom_point(mapping=aes(x=TotalMinutesAsleep, y=FairlyActiveMinutes, color="FairlyActiveMinutes")) +
  geom_smooth(mapping=aes(x=TotalMinutesAsleep, y=FairlyActiveMinutes, regLineColor="blue")) +
  labs(title="The Relationship Between Activity Levels and Total Minutes Asleep", x="Total Minutes Asleep", y="Minutes of Activity")
```

```{r my_plot_b, echo=FALSE}
plot(my_plot_b)
```

```{r}
my_plot_c <- ggplot(data=combined_data) +
  geom_point(mapping=aes(x=TotalMinutesAsleep, y=LightlyActiveMinutes, color="LightlyActiveMinutes")) +
  geom_smooth(mapping=aes(x=TotalMinutesAsleep, y=LightlyActiveMinutes, regLineColor="blue")) +
  labs(title="The Relationship Between Activity Levels and Total Minutes Asleep", x="Total Minutes Asleep", y="Minutes of Activity")
```


```{r my_plot_c, echo=FALSE}
plot(my_plot_c)
```
```{r}
my_plot_d <- ggplot(data=combined_data) +
  geom_point(mapping=aes(x=TotalMinutesAsleep, y=SedentaryMinutes, color="SedentaryMinutes")) +
  geom_smooth(mapping=aes(x=TotalMinutesAsleep, y=SedentaryMinutes, regLineColor="blue")) +
  labs(title="The Relationship Between Activity Levels and Total Minutes Asleep", x="Total Minutes Asleep", y="Minutes of Activity")
```

```{r my_plot_d, echo=FALSE}
plot(my_plot_d)
```

## Act
**Recommendation:** <br>

* Encourage consumers to utilize a wifi-connected scale rather than manually entering their weights in order to collect more data for a thorough study.

* Organize campaigns encouraging users to engage in short, active workouts throughout the week and lengthier workouts on the weekends, particularly on Sunday when we observe the lowest step counts and highest inactive minutes.

* A point-based reward system can be used in conjunction with a healthy educational campaign. Users who complete the whole week's workout will earn Bellabeat points redeemable for merchandise or subscriptions.

* When a user has been sitting still for a long time, a gadget like the Leaf health tracker can beat or vibrate to remind them to move about. In a similar manner, it can alert the user to the need for sleep after detecting an extended period of time spent awake in bed.